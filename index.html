<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ATS Resume Analyzer</title>

    <style>
        body {
            font-family: "Inter", Arial, sans-serif;
            background: #eef2f7;
            margin: 0;
            padding: 30px;
        }

        .container {
            max-width: 900px;
            margin: auto;
            padding: 30px;
            background: white;
            border-radius: 14px;
            box-shadow: 0 5px 25px rgba(0,0,0,0.07);
        }

        h2 {
            margin-bottom: 20px;
            font-size: 26px;
            font-weight: 800;
            letter-spacing: -1px;
            color: #1d2b53;
        }

        input[type="file"] {
            margin-bottom: 20px;
            padding: 10px;
        }

        button {
            padding: 12px 22px;
            background: #4a6bff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: 0.2s ease;
        }

        button:hover {
            background: #2747ff;
        }

        #loading {
            display: none;
            margin-top: 15px;
            font-weight: bold;
            color: #2747ff;
        }

        #result-area {
            margin-top: 30px;
        }

        /* ---------------- CIRCULAR SCORE ---------------- */
        .score-wrapper {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
        }

        .circular-score {
            width: 170px;
            height: 170px;
            border-radius: 50%;
            background: conic-gradient(#4a6bff var(--value), #d9e1ff 0deg);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            transition: .5s ease;
        }

        .circular-score::before {
            content: "";
            width: 130px;
            height: 130px;
            background: white;
            border-radius: 50%;
            position: absolute;
        }

        .score-text {
            position: absolute;
            font-size: 34px;
            font-weight: 800;
            color: #4a6bff;
        }

        /* ---------------- CATEGORY CARD ---------------- */
        .category-card {
            background: #ffffff;
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 18px;
            border-left: 6px solid #4a6bff;
            box-shadow: 0 3px 14px rgba(0,0,0,0.05);
        }

        .category-title {
            font-size: 18px;
            font-weight: 700;
            color: #233043;
            margin-bottom: 8px;
            text-transform: capitalize;
        }

        .score {
            font-size: 16px;
            font-weight: bold;
            color: #2747ff;
            margin-bottom: 10px;
        }

        .summary-text, .improvements {
            margin-top: 8px;
            font-size: 14px;
            color: #333;
            line-height: 1.5;
        }

        .improvements {
            color: #4b4b4b;
        }
    </style>
</head>

<body>

<div class="container">
    <h2>ATS Resume Analyzer</h2>

    <label><b>Upload Resume (PDF):</b></label><br>
    <input type="file" id="resume" accept="application/pdf"><br>

    <label><b>Upload Job Description (PDF):</b></label><br>
    <input type="file" id="jd" accept="application/pdf"><br>

    <button onclick="runATS()">Analyze Resume</button>

    <div id="loading">⏳ Processing... Please wait...</div>

    <div id="result-area"></div>
</div>


<script>
async function runATS() {

    const resumeFile = document.getElementById("resume").files[0];
    const jdFile = document.getElementById("jd").files[0];

    if (!resumeFile || !jdFile) {
        alert("Please upload both Resume and Job Description.");
        return;
    }

    let formData = new FormData();
    formData.append("resume", resumeFile);
    formData.append("jd", jdFile);

    document.getElementById("loading").style.display = "block";
    document.getElementById("result-area").innerHTML = "";

    try {
        const response = await fetch("/model", {
            method: "POST",
            body: formData
        });

        const jsonData = await response.json();

        if (jsonData.error) {
            document.getElementById("result-area").innerHTML =
                "<div style='color:red;'>Backend Error: " + jsonData.error + "</div>";
            return;
        }

        renderATS(jsonData);

    } catch (err) {
        document.getElementById("result-area").innerHTML =
            "<div style='color:red;'>Error: " + err + "</div>";
    }

    document.getElementById("loading").style.display = "none";
}

function renderATS(data) {

    let output = "";

    /* ===== Overall Score Circular Bar ===== */
    const angle = (data.overall_score / 100) * 360;

    output += `
        <div class="score-wrapper">
            <div class="circular-score" style="--value: ${angle}deg;">
                <div class="score-text">${data.overall_score}%</div>
            </div>
        </div>
    `;

    /* ===== Category Cards ===== */
    for (const [category, details] of Object.entries(data.categories)) {

        output += `
            <div class="category-card">
                <div class="category-title">${category.replaceAll("_", " ")}</div>

                <div class="score">
                    Score: ${details.score}% — ${details.status}
                </div>

                <div class="summary-text">
                    <b>Summary:</b><br> ${details.summary}
                </div>

                <div class="improvements">
                    <b>Improvements:</b><br>
                    ${details.improvements}
                </div>
            </div>
        `;
    }

    document.getElementById("result-area").innerHTML = output;
}
</script>

</body>
</html>
